<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>Upload e Leitura de Planilha</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    input[type=file] { margin-bottom: 10px; }
  </style>
</head>
<body>
  <h1>Upload da Planilha Excel</h1>
  <input type="file" id="input-excel" accept=".xlsx,.xls" />
  <button id="btn-abrir-tabela" disabled>Abrir Tabela</button>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <script>
    const inputExcel = document.getElementById("input-excel");
    const btnAbrirTabela = document.getElementById("btn-abrir-tabela");

    let excelData = null;

    inputExcel.addEventListener("change", (e) => {
      const file = e.target.files[0];
      if (!file) return;

      const reader = new FileReader();
      reader.onload = (evt) => {
        const data = evt.target.result;
        const workbook = XLSX.read(data, { type: "binary" });
        const firstSheetName = workbook.SheetNames[0];
        const worksheet = workbook.Sheets[firstSheetName];
        excelData = XLSX.utils.sheet_to_json(worksheet, { header: 1, defval: "" });
        btnAbrirTabela.disabled = false;
      };
      reader.readAsBinaryString(file);
    });

    btnAbrirTabela.addEventListener("click", () => {
      if (!excelData) return alert("Por favor, carregue uma planilha primeiro.");
      localStorage.setItem("excelData", JSON.stringify(excelData));
      window.open("app/tabela.html", "_blank");
    });
  </script>
</body>
</html>

